

<h2>{{patientName}}</h2>

<h2>Cancer Summary</h2>

<div id="cancers"></div>

<h2>Tumor Summary</h2>

<div id="tumors"></div>

<h2>Reports</h2>

<div id="reports"></div>

<h2>Individual Report: <span id="report_id"></span></h2>

<div id="report_content"></div>

<script type="text/javascript">
var patientName = '{{patientName}}';
var baseUri = '{{baseUri}}';

// Get cancer summary
function getCancerSummary(patientName) {
	// Separate the ajax request with callbacks
	var jqxhr = $.ajax({
	    url: baseUri + '/patients/' + patientName + '/cancers',
	    method: 'GET', 
	    async : true,
	    dataType : 'text' // Use 'text' instead of 'json' for rendered html content
	});

	jqxhr.done(function(response) {
	    //console.log(response);

	    // Render response
	    //$('#cancers').html('<pre>' + JSON.stringify(response, null, 4) + '</pre>');
	    $('#cancers').html(response);
	});

	jqxhr.fail(function () { 
	    console.log("Ajax error - can't get cancer summary");
	});
}

// Get tumor summary
function getTumorSummary(patientName, cancerId) {
	// Separate the ajax request with callbacks
	var jqxhr = $.ajax({
	    url: baseUri + '/patients/' + patientName + '/' + cancerId + '/tumors',
	    method: 'GET', 
	    async : true,
	    dataType : 'text' // Use 'text' instead of 'json' for rendered html content
	});

	jqxhr.done(function(response) {
	    //console.log(response);

	    // Render response
	    $('#tumors').html(response);
	});

	jqxhr.fail(function () { 
	    console.log("Ajax error - can't get cancer summary");
	});
}

// Get reports
function getReports(patientName) {
	// Separate the ajax request with callbacks
	var jqxhr = $.ajax({
	    url: baseUri + '/patients/' + patientName + '/reports',
	    method: 'GET', 
	    async : true,
	    dataType : 'text' // Use 'text' instead of 'json' for rendered html content
	});

	jqxhr.done(function(response) {
	    //console.log(response);
	    
	    // Render response
	    //$('#reports').html('<pre>' + JSON.stringify(response, null, 4) + '</pre>');
	    $('#reports').html(response);
	});

	jqxhr.fail(function () { 
	    console.log("Ajax error - can't get reports");
	});
}

// Get reports
function getReport(reportId) {
	// Separate the ajax request with callbacks
	var jqxhr = $.ajax({
	    url: baseUri + '/reports/' + reportId,
	    method: 'GET', 
	    async : true,
	    dataType : 'json'
	});

	jqxhr.done(function(response) {
	    //console.log("Report: " + reportId);

	    // Render response
	    $('#report_id').html(reportId);
	    $('#report_content').html('<pre>' + response.data[0][0].data.text + '</pre>');
	});

	jqxhr.fail(function () { 
	    console.log("Ajax error - can't get report");
	});
}




// Get patient cancer symmary and reports
getCancerSummary(patientName);

// Hard coded cancer ID for now
getTumorSummary(patientName, 'CancerSummary-Breast');

getReports(patientName);


</script>